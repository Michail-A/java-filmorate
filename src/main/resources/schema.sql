CREATE TABLE IF NOT EXISTS ratings (
 	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
 	name varchar NOT NULL,
 	PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS genre (
   	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
   	name varchar NOT NULL,
   	PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS films (
  	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  	name varchar NOT NULL,
  	description varchar NOT NULL,
  	releaseDate TIMESTAMP NOT NULL,
  	duration INTEGER NOT NULL,
  	ratings_id INTEGER NOT NULL,
  	PRIMARY KEY (id)
);
CREATE TABLE film_genres (
    film_id INTEGER NOT NULL,
    genre_id INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS users (
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	email varchar NOT NULL,
	login varchar NOT NULL,
	name varchar,
	birthday TIMESTAMP NOT NULL,
	PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS likes_films (
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	films_id INTEGER NOT NULL,
	users_id INTEGER NOT NULL,
	PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS friends (
	user_id INTEGER NOT NULL,
	friend_id INTEGER NOT NULL
);

ALTER TABLE films ADD CONSTRAINT films_fk0 FOREIGN KEY (ratings_id) REFERENCES ratings(id);

ALTER TABLE likes_films ADD CONSTRAINT likes_films_fk0 FOREIGN KEY (films_id) REFERENCES films(id) ON DELETE CASCADE;

ALTER TABLE likes_films ADD CONSTRAINT likes_films_fk1 FOREIGN KEY (users_id) REFERENCES users(id) ON DELETE CASCADE;

ALTER TABLE friends ADD CONSTRAINT friends_fk0 FOREIGN KEY (user_id) REFERENCES users(id);

ALTER TABLE friends ADD CONSTRAINT friends_fk1 FOREIGN KEY (friend_id) REFERENCES users(id);

ALTER TABLE film_genres ADD CONSTRAINT film_genres_fk0 FOREIGN KEY (film_id) REFERENCES films(id);

ALTER TABLE film_genres ADD CONSTRAINT film_genres_fk1 FOREIGN KEY (genre_id) REFERENCES genre(id);








